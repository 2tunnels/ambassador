<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Ambassador - How it works</title>
  <meta name="description" content="Ambassador, API Gateway built on Envoy">
  <meta name="keywords" content="Ambassador, Envoy, Kubernetes, microservices">
  <meta name="author" content="Datawire.io">
  <meta name="generator" content="Doc42 0.1.0">

  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,600,700' type='text/css' media='all' />
  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
  <link rel="stylesheet" href="/css/kissui.css">
  <link rel="stylesheet" href="/css/custom.css">
  <link rel="stylesheet" href="/css/sticky.min.css">

  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-57322503-8', 'auto');ga('send', 'pageview');</script>
  <link rel="canonical" href="http://localhost:4000/about/how-it-works.html">
  <link rel="alternate" type="application/rss+xml" title="Ambassador" href="http://localhost:4000/feed.xml">
</head>


  <body>
      <div class="row">
    <header id="main_header">
        <nav class="basic border menu">
            <div class="fluid">
                <a class="header item" href="/">
                    Ambassador
                </a>

                <a class="item" href="/user-guide/getting-started.html">
                  <i class="fa fa-download"></i> Get Started
                </a>
                <a class="item" href="/about/why-telepresence.html">
                  <i class="fa fa-book"></i> Documentation
                </a>
                <a class="item" href="https://github.com/datawire/telepresence/" target="_blank">
                    <i class="fa fa-github"></i> GitHub
                </a>
                <a class="item" href="https://gitter.im/datawire/telepresence" target="_blank">
                    <i class="fa fa-support"></i> Need help?
                </a>
            </div>
        </nav>
    </header>
</div>


      <div class="fluid">
          <div class="wrapper">
              <div class="row">
    <div class="two columns">
        <nav class="basic border fluid vertical menu" data-kui-sticky>
    

    <div class="items">
        <div class="icon item header">
            <i class="fa fa-question-circle"></i>about
        </div>
        

        
            
                      
            
                      
            
                      
            
                      
            
              
                      
                      
            
              
                      
                      
            
              
                
                      <a class="item" href="/about/why-telepresence.html">Why Telepresence?</a>
                      
                      
                      
                      
            
              
                      
                      
            
              
                      
                      
            
              
                
                      <a class="item" href="/about/how-it-works.html">How it works</a>
                      
                      
                      
                      
            
              
                      
                      
    </div>

    <div class="items">
        <div class="icon item header">
            <i class="fa fa-play"></i>getting started
        </div>
        

        
            
                      
            
                      
            
                      
            
                      
            
              
                      
                      
            
              
                      
                      
            
              
                      
                      
            
              
                      
                      
            
              
                      
                      
            
              
                      
                      
            
              
                      
                      
    </div>

    <div class="items">
        <div class="icon item header">
            <i class="fa fa-code"></i>user guide
        </div>
        

        
            
                      
            
                      
            
                      
            
                      
            
              
                      
                      
            
              
                
                      <a class="item" href="/user-guide/getting-started.html">Getting Started</a>
                      
                      
                      
                      
            
              
                      
                      
            
              
                
                      <a class="item" href="/user-guide/features-and-functionality.html">Features and Functionality</a>
                      
                      
                      
                      
            
              
                      
                      
            
              
                      
                      
            
              
                
                      <a class="item" href="/user-guide/limitations-and-workarounds.html">Limitations and Workarounds</a>
                      
                      
                      
                      
    </div>

    <div class="items">
        <div class="icon item header">
            <i class="fa fa-expand"></i>additional information
        </div>
        

        
            
                      
            
                      
            
                      
            
                      
            
              
                
                      <a class="item" href="/additional-information/changelog.html">Changelog</a>
                      
                      
                      
                      
            
              
                      
                      
            
              
                      
                      
            
              
                      
                      
            
              
                
                      <a class="item" href="/additional-information/developing.html">Development Info</a>
                      
                      
                      
                      
            
              
                      
                      
            
              
                      
                      
    </div>
    <div class="items">
      <div class="icon item header">
        <i class="fa fa-external-link"></i>EXTERNAL LINKS
      </div>
      <a class="item" href="https://cloud.google.com/community/tutorials/developing-services-with-k8s">Telepresence on GKE</a>
      <a class="item" href="https://www.datawire.io/guide/deployment/development-environments-microservices/">Microservice development environments</a>
    </div>
</nav>

    </div>

    <div class="eight columns page-content">
        <header class="post-header">
            <h2 class="post-title">How it works</h3>
        </header>

        <div class="post-content docs">
          <h3 id="why-it-works-the-way-it-does">Why it works the way it does</h3>

<p>Our goals for Telepresence are:</p>

<ol>
  <li><strong>Transparency:</strong> make the local proxied process match the Kubernetes environment as closely as possible.</li>
  <li><strong>Isolation:</strong> only the proxied process has its environment modified.
 This goal is very much like that of a container: an isolated process-specific environment.</li>
  <li><strong>Cross-platform:</strong> Linux and macOS work the same way, when possible.
In general Linux provides far more capabilities (mount namespaces, bind mounts, network namespaces) than macOS.</li>
</ol>

<p>Achieving all these goals is not always possible, of course.</p>

<p>One approach we considered early on was using a VPN for network proxying, but that is hard to reconcile with the goal of isolation (at least on macOS.)
Our chosen approach, described below, suffers from <a href="/user-guide/limitations-and-workarounds.html">some limitations</a>, so we might add support for VPN-based proxying in the future.
If this interests you please leave a comment or vote on the <a href="https://github.com/datawire/telepresence/issues/128">VPN issue in GitHub</a>.</p>

<h3 id="how-it-works">How it works</h3>

<p>Telepresence works by building a two-way network proxy (bootstrapped using <code class="highlighter-rouge">kubectl port-forward</code>) between a custom pod running inside a remote Kubernetes cluster and a process running on your development machine.
The custom pod is substituted for your normal pod that would run in production.</p>

<p>Environment variables from the remote pod are made available to your local process.
In addition, the local process has its networking transparently overridden such that DNS calls and TCP connections are routed over the proxy to the remote Kubernetes cluster.
This is implemented using <code class="highlighter-rouge">LD_PRELOAD</code>/<code class="highlighter-rouge">DYLD_INSERT_LIBRARIES</code> mechanism on Linux/OSX, where a shared library can be injected into a process and override library calls.</p>

<p>Volumes are proxied using <a href="https://github.com/libfuse/sshfs">sshfs</a>, with their location available to the container as an environment variable.</p>

<p>The result is that your local process has a similar environment to the remote Kubernetes cluster, while still being fully under your local control.</p>



          <div><strong>Still have questions? Ask in our <a href="https://gitter.im/datawire/ambassador">Gitter chatroom</a> or <a href="https://github.com/datawire/ambassador/issues/new">file an issue on GitHub</a>.</strong></div>
        </div>
    </div>

    <div id="contents" class="two columns">
        <div data-kui-sticky></div>
    </div>
</div>

          </div>
      </div>

      <div class="grid">
  <div class="row">
    <footer class="basic menu top border">
      <div class="fluid">
        <span class="right header item">Copyright &copy; 2017 <a href="https://datawire.io">Datawire.io</a></span>
      </div>
    </footer>
  </div>
</div>
<script src="/js/sticky.min.js"></script>


      <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-85887707-1', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
